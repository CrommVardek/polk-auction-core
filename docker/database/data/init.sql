CREATE DATABASE IF NOT EXISTS POLKAUCTION;

USE POLKAUCTION;

DROP TABLE IF EXISTS RELAY_CHAIN;

DROP TABLE IF EXISTS PARACHAIN;

CREATE TABLE RELAY_CHAIN (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    CHAIN_NAME VARCHAR(250) NOT NULL,
    CONSTRAINT U_CHAIN_NAME UNIQUE (CHAIN_NAME)
);

CREATE TABLE PARACHAIN (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    RELAY_CHAIN_ID INT NOT NULL,
    PARACHAIN_ID INT NOT NULL,
    PARACHAIN_NAME VARCHAR(250) NOT NULL,
    WEBSITE VARCHAR(500) NOT NULL,
    FOREIGN KEY (RELAY_CHAIN_ID)
        REFERENCES RELAY_CHAIN (ID)
        ON DELETE CASCADE,
    CONSTRAINT U_PARA_RELAY UNIQUE (RELAY_CHAIN_ID, PARACHAIN_ID)
);

COMMIT;

INSERT INTO RELAY_CHAIN
    (ID, CHAIN_NAME)
VALUES
    (1, 'Polkadot'),
    (2, 'Kusama')
;

COMMIT;